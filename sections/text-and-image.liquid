<style>
  #shopify-section-{{ section.id }} {
    background-color:{{ section.settings.background_color }};
    color:{{ section.settings.text_color }};

    {% if section.settings.background_color %}
      margin: 0;
    {% endif %}

    {% if section.settings.add_margin %}
      margin-bottom: 40px;
    {% endif %}

  }

  #shopify-section-{{ section.id }} .h3,
  #shopify-section-{{ section.id }} .detail-iconsOnly__wrapper .detail-icon .detail-icon__heading  {
    color:{{ section.settings.text_color }};
  }

  #shopify-section-{{ section.id }} .h3 .title-colored {
    color:{{ section.settings.accent_color }};
  }

  #shopify-section-{{ section.id }} .btn {
    background-color:{{ section.settings.accent_color }};
}
</style>




{%- if section.settings.divider -%}<div class="section--divider">{%- endif -%}

<div class="page-width full-width">
  {%- capture image_layout -%}
    <div class="feature-row__item">
      <div style="margin: 0 auto; max-width: {{ section.settings.image_width }}px;">
        {%- if section.settings.image != blank -%}
          {%- if section.settings.button_label != blank and section.settings.button_link != blank %}<a href="{{ section.settings.button_link }}">{% endif -%}
          <div class="image-wrap" style="height: 0; padding-bottom: {{ 100 | divided_by: section.settings.image.aspect_ratio }}%;">
            {%- assign img_url = section.settings.image | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
            <img class="feature-row__image lazyload"
                loading="lazy"
                data-src="{{ img_url }}"
                data-widths="[180, 360, 540, 720, 900, 1080]"
                data-aspectratio="{{ section.settings.image.aspect_ratio }}"
                data-sizes="auto"
                alt="{{ section.settings.image.alt }}"
                width="100%"
                height="{{ section.settings.image.aspect_ratio }}*{{ width }}">
          </div>
          {%- if section.settings.button_label != blank and section.settings.button_link != blank %}</a>{% endif -%}
        {%- else -%}
          <div class="image-wrap">
            {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
          </div>
        {%- endif -%}
      </div>
    </div>
  {%- endcapture -%}

  <div class="feature-row" data-aos>
    {%- if section.settings.layout == 'left' -%}
      {{ image_layout }}
    {%- endif -%}

    <div class="feature-row__item feature-row__text feature-row__text--{{ section.settings.layout }}">
      {%- if section.settings.subtitle != blank -%}
        <p class="h5">{{ section.settings.subtitle }}</p>
      {%- endif -%}
      {%- if section.settings.title_colored != blank or section.settings.title != blank -%}
        <p class="h3"><span class="title-colored">{{ section.settings.title_colored | escape }}</span> {{ section.settings.title | escape }}</p>
      {%- endif -%}
      {%- if section.settings.text != blank -%}
        <div class="rte featured-row__subtext">{{ section.settings.text }}</div>
      {%- endif -%}

      {% if section.settings.icons_only %}

        <div class="detail-iconsOnly__wrapper">
          {% for block in section.blocks %}
            <div class="detail-icon">
              <img class="lazyload"
                      loading="lazy"
                      data-src="{{ block.settings.image | img_url: '60x' }}"
                      data-widths="[180, 360, 540, 720, 900, 1080]"
                      data-aspectratio="{{ block.settings.image.aspect_ratio }}"
                      data-sizes="auto"
                      alt="{{ block.settings.image.alt }}"
                      width="100%"
                      height="{{ section.settings.image.aspect_ratio }}*{{ width }}">
              <div class="detail-icon__heading">{{ block.settings.title }}</div>
            </div>
          {% endfor %}
        </div>

      {% else %}

        <div class="detail-rows__wrapper">
          {% for block in section.blocks %}
            <div class="detail-row">
              <div class="detail-row__image">
                <img class="lazyload"
                      loading="lazy"
                      data-src="{{ block.settings.image | img_url: '60x' }}"
                      data-widths="[180, 360, 540, 720, 900, 1080]"
                      data-aspectratio="{{ block.settings.image.aspect_ratio }}"
                      data-sizes="auto"
                      alt="{{ block.settings.image.alt }}"
                      width="100%"
                      height="{{ section.settings.image.aspect_ratio }}*{{ width }}">
              </div>
              <div class="detail-row__text">
                <span class="row-heading">{{ block.settings.title }}</span>
                <span class="row-mainText">{{ block.settings.main_text }}</span>
              </div>
            </div>
          {% endfor %}
        </div>

        {% endif %}

      {%- if section.settings.button_label != blank -%}
        <a href="{{ section.settings.button_link }}" class="btn">
          {{ section.settings.button_label }}
        </a>
      {%- endif -%}
    </div>

    {%- if section.settings.layout == 'right' -%}
      {{ image_layout }}
    {%- endif -%}
  </div>
</div>

{%- if section.settings.divider -%}</div>{%- endif -%}

{% schema %}
{
    "name": "Image with text",
    "class": "index-section",
    "settings": [
        {
            "type": "color",
            "id": "background_color",
            "label": "Background Colour"
        },
        {
            "type": "color",
            "id": "text_color",
            "label": "Text Colour"
        },
        {
            "type": "color",
            "id": "accent_color",
            "label": "Accent Colour"
        },
        {
            "type": "checkbox",
            "id": "add_margin",
            "label": "Add margin",
            "default": false
        },
        {
            "type": "image_picker",
            "id": "image",
            "label": "Image"
        },
        {
            "type": "range",
            "id": "image_width",
            "label": "Image width",
            "default": 500,
            "min": 100,
            "max": 700,
            "step": 10,
            "unit": "px"
        },
        {
            "type": "text",
            "id": "subtitle",
            "label": "Subheading",
            "default": "Improved"
        },
        {
            "type": "text",
            "id": "title_colored",
            "label": "Heading (coloured)",
            "default": "Image with text"
        },
        {
            "type": "text",
            "id": "title",
            "label": "Heading (dark)"
        },
        {
            "type": "richtext",
            "id": "text",
            "label": "Text",
            "default": "<p>Pair large text with an image to tell a story, explain a detail about your product, or describe a new promotion.</p>"
        },
        {
            "type": "text",
            "id": "button_label",
            "label": "Button label",
            "default": "Optional button"
        },
        {
            "type": "url",
            "id": "button_link",
            "label": "Button link"
        },
        {
            "type": "select",
            "id": "layout",
            "label": "Layout",
            "default": "left",
            "options": [
                {
                    "value": "left",
                    "label": "Image on left"
                },
                {
                    "value": "right",
                    "label": "Image on right"
                }
            ]
        },
        {
            "type": "checkbox",
            "id": "divider",
            "label": "Show section divider",
            "default": false
        },
        {
            "type": "checkbox",
            "id": "icons_only",
            "label": "Icons only",
            "default": false
        }
    ],
    "blocks": [
        {
            "type": "text_and_image",
            "name": "Text and image",
            "settings": [
                {
                    "type": "image_picker",
                    "id": "image",
                    "label": "Image"
                },
                {
                    "type": "text",
                    "id": "title",
                    "label": "Heading"
                },
                {
                    "type": "text",
                    "id": "main_text",
                    "label": "Main Text"
                }
            ]
        }
    ],
    "presets": [
        {
            "name": "Image with text",
            "category": "Image"
        }
    ]
}
{% endschema %}
